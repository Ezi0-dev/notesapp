<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Secure Notes</title>
  <link rel="stylesheet" href="../css/dashboard.css">
</head>
<body>
  <!-- Top Navigation Bar -->
  <nav class="navbar">
    <div class="navbar-container">
      <div class="navbar-brand">
        <h1>üîê Secure Notes</h1>
      </div>
      <div class="navbar-menu">
        <div class="profile-actions">
          <div class="notifications-dropdown">
            <button class="btn btn-notifications" id="notificationsBtn">
                <span class="logout-icon">üîî</span>
                <span class="logout-text">Notifications</span>
            </button>
            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>

            <div class="notifications-dropdown-content" id="notificationsDropdown" style="display: none;">
              <div class="notifications-header">
                <h3>Notifications</h3>
                <button class="btn-mark-all-read" id="markAllReadBtn">Mark all as read</button>
              </div>

              <div class="notifications-list" id="notificationsList">
                <!-- Notifications will be populated here by JavaScript -->
              </div>

              <div class="notifications-empty" id="notificationsEmpty" style="display: none;">
                <span class="empty-icon">üîî</span>
                <p>No notifications</p>
              </div>
            </div>
          </div>

          <a href="/profile.html" class="profile-button">
              <div class="profile-button-avatar" id="dashboardAvatar"></div>
              <div class="profile-button-info">
                  <span class="profile-button-name" id="dashboardUsername">Loading...</span>
                  <span class="profile-button-link">‚öôÔ∏è Edit Profile</span>
              </div>
          </a>

          <a href="/friends.html" class="btn btn-friends" id="friendsBtn">
              <span class="logout-icon">üôÇ</span>
              <span class="logout-text">Friends</span>
          </a>

          <button class="btn btn-logout" id="logoutBtn">
              <span class="logout-icon">üëã</span>
              <span class="logout-text">Logout</span>
          </button>
      </div>
    </div>
  </nav>

  <!-- Main Dashboard Content -->
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <button id="newNoteBtn" class="btn btn-primary btn-block">
        ‚ûï New Note
      </button>
      
      <div class="search-box">
        <h3>Search</h3>
        <div class="search-input-wrapper">
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="Search notes..."
          >
        </div>
      </div>

      <div class="sidebar-section">
        <h3>Statistics</h3>
        <div class="stat-item">
          <span class="stat-label">Total Notes:</span>
          <span class="stat-value" id="totalNotes">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Encrypted:</span>
          <span class="stat-value" id="encryptedNotes">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Shared Notes:</span>
          <span class="stat-value" id="sharedNotes">0</span>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Success/Error Messages -->
      <div id="successMessage" class="message success-message" style="display: none;"></div>
      <div id="noteError" class="message error-message" style="display: none;"></div>

      <!-- Loading State -->
      <div id="loadingSpinner" class="loading-spinner" style="display: none;">
        <div class="spinner"></div>
        <p>Loading notes...</p>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state" style="display: none;">
        <div class="empty-icon">üìù</div>
        <h3>No notes yet</h3>
        <p>Create your first secure note by clicking the "New Note" button</p>
      </div>

      <!-- Notes Grid -->
      <div id="notesContainer" class="notes-grid">
        <!-- Notes will be inserted here by JavaScript -->
      </div>
    </main>
  </div>

  <!-- Note Modal -->
  <div id="noteModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">New Note</h2>
        <button id="closeModal" class="modal-close">&times;</button>
      </div>

      <form id="noteForm" class="note-form">
        <div class="form-group">
          <label for="noteTitle">Title</label>
          <input 
            type="text" 
            id="noteTitle" 
            class="form-input" 
            placeholder="Enter note title"
            required
            maxlength="255"
          >
        </div>

        <div class="form-group">
          <label for="noteContent">Content</label>
          <textarea 
            id="noteContent" 
            class="form-textarea" 
            placeholder="Start typing your note..."
            rows="12"
            required
            maxlength="50000"
          ></textarea>
        </div>

        <div class="form-group encryption-option">
          <label class="checkbox-label">
            <input type="checkbox" id="noteEncrypted" checked>
            <span>üîí Encrypt this note (recommended)</span>
          </label>
        </div>

        <div class="modal-actions" id="modalContainer">
          <button type="button" id="cancelBtn" class="btn btn-secondary">Cancel</button>
          <button type="submit" id="saveNoteBtn" class="btn btn-primary">Save Note</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Share Note Modal -->
<div id="shareModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Share Note</h2>
      <button id="closeShareModal" class="modal-close" aria-label="Close modal">&times;</button>
    </div>
    <div id="shareError" class="error-message"></div>
    <form id="shareForm" class="note-form">
      <div class="form-group">
        <label for="shareFriendSelect">Select Friend</label>
        <select id="shareFriendSelect" required>
          <option value="">Choose a friend...</option>
        </select>
      </div>
      <div class="form-group">
        <label for="sharePermissionSelect">Permission</label>
        <select id="sharePermissionSelect">
          <option value="read">Read Only</option>
          <option value="write">Read & Write</option>
        </select>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" id="cancelShareBtn">Cancel</button>
        <button type="submit" class="btn btn-primary" id="shareBtn"><span class="btn-text">Share</span></button>
      </div>
    </form>
  </div>
</div>

<div id="manageSharesModal" class="modal" style="display: none;">
  <div class="modal-content modal-shares">
    <div class="modal-header">
      <h2>Manage Shares</h2>
      <button id="closeManageSharesModal" class="modal-close" aria-label="Close modal">&times;</button>
    </div>
    <div id="manageSharesError" class="error-message"></div>
    <div id="sharesList" class="shares-list"></div>
  </div>
</div>

  <!-- IMPORTANT: Load scripts in this exact order -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js"></script>

  <script src="../js/api.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/notifications.js"></script>
  <script src="../js/dashboard.js"></script>
</body>
</html>

    <!-- Confirmation Modal -->
<div id="confirmModal" class="confirm-modal">
    <div class="confirm-content">
        <div class="confirm-header">
            <span id="confirmIcon" class="confirm-icon">‚ö†Ô∏è</span>
            <h3 id="confirmTitle">Confirm Action</h3>
        </div>
        <div class="confirm-body">
            <p id="confirmMessage">Are you sure you want to proceed?</p>
        </div>
        <div class="confirm-actions">
            <button class="btn btn-cancel" id="confirmCancel">Cancel</button>
            <button class="btn btn-confirm" id="confirmOk">Confirm</button>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div id="toast" class="toast">
    <span class="toast-icon">‚úì</span>
    <div class="toast-content">
        <div class="toast-title" id="toastTitle">Success</div>
        <div class="toast-message" id="toastMessage">Action completed</div>
    </div>
</div>

